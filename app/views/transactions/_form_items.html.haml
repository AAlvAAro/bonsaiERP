%h2.dark#items_header Items

%table#items_table.decorated
  %thead
    %tr
      %th.item Item
      -#%th.description Descripción
      %th.price
        Precio unitario
        %span.currency
      %th.quantity Cantidad
      %th.total_row Total fila
      %th

  - @items = transaction.get_items

  = f.simple_fields_for :transaction_details do |fd|
    %tr.item{:id => fd.object.id}
      %td
        %input.desc{:type => 'text', :size => 50, :value => fd.object.item}
        = fd.input :item_id, :label => false, :input_html => {:class => 'item_id'}

      %td= fd.input :price, :input_html => { :size => 8, :class => 'price', :type => 'decimal', 'data-original_price' => fd.object.original_price },
        :label => false
      %td= fd.input :quantity, :input_html => { :size => 8, :class => 'quantity', :type => 'decimal' }, :label => false

      %td.total_row.r{'data-val' => fd.object.total }= ntc fd.object.total
      %td.del <a href="javascript:" class="destroy" title="Borrar">&nbsp;</a>
  
  %tr.extra.pad_top.subtotal
    %td
    %td.cur{:colspan => 2} Subtotal
    %td#subtotal.r{'data-val' => transaction.subtotal}= ntc(transaction.subtotal)
  
  %tr.extra
    %td <a href="javascript:" id="add_item" class="add link">Adicionar ítem</a>
    %td.cur.discount{:colspan => 2} 
      - if transaction.is_a? Income
        = f.input :discount, 
          :label => "#{minus_image} Descuento".html_safe, 
          :input_html => {:size => 4, :type => 'decimal', :id => 'transaction_discount'}, 
          :wrapper_html => {:class => 'boolean', :style => 'width: 100%'}
          
    - if transaction.is_a? Income
      %td#discount_total.r{'data-val' => transaction.total_discount} #{ntc(transaction.total_discount)}
  
  - if transaction.is_a? Income
    %tr.extra
      %td
      %td.cur.line{:colspan => 2} Impuestos (<span id="taxes_percentage" data-val="#{transaction.tax_percent}">#{ntc transaction.tax_percent}</span>%)
      %td#taxes_total.r.line{'data-val' => transaction.total_taxes}= ntc transaction.total_taxes
  
  %tr.extra
    %td
    %td.r.b.dark{:colspan => 2} Total
    %td.b.cur
      %span.currency
      %span#total_value.cur{ 'data-val'=> transaction.total}= ntc transaction.total

.actions
  = f.submit 'Salvar'
