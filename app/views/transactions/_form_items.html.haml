%h2.dark#items_header Items

%table#items_table.table
  %thead
    %tr
      %th.item Item
      -#%th.description Descripción
      %th.price
        Precio unitario
        %span.currency
      %th.quantity Cantidad
      %th.total_row Total fila
      %th

  -# @items = transaction.get_items

  = f.simple_fields_for :transaction_details do |fd|
    %tr.item{:id => fd.object.id}
      %td
        %input.desc{:type => 'text', :size => 50, :value => fd.object.item, :placeholder => "Escriba para buscar el ítem"}
        = fd.input :item_id, :label => false, :input_html => {:class => 'item_id'}

      %td= fd.input :price, :input_html => { :size => 8, :class => 'price', :type => 'decimal', 'data-original_price' => fd.object.original_price },
        :label => false
      %td= fd.input :quantity, :input_html => { :size => 8, :class => 'quantity', :type => 'decimal' }, :label => false

      %td.total_row.r{'data-val' => fd.object.total }= ntc fd.object.total
      %td.del <a href="javascript:" class="destroy" title="Borrar">&nbsp;</a>
  
  %tr.extra.pad_top.subtotal
    %td
    %td.cur{:colspan => 2} Subtotal
    %td#subtotal.cur{'data-val' => transaction.subtotal}= ntc(transaction.subtotal)
    %td
  
  %tr.extra
    %td 
      %a(href="javascript:" id="add_item" class="btn btn-primary")
        %i.icon-plus-sign.icon-white
        Adicionar ítem

  %tr.extra
    %td
    %td.r.b.dark(colspan='2') Total
    %td.b(colspan='2')= f.input :total, label: false, input_html: { type: 'decimal', size: 12, id: 'total', class: 'b' }
  - if transaction.is_a?(Income)
    %tr
      %td.cur.b.gray(colspan='3') 
        Descuento<br/>
      %td.discount.cur
        %span.discount
        %br
        %span.discount-per

.clear
%br
= f.submit 'Salvar', :class => 'btn btn-success b btn-large'
