= simple_form_for inv do |f|
  = f.hidden_field :store_id
  .row-fluid
    .span3
      %label Almacen
      %h4.n= link_to inv.store, inv.store, target: '_blank'
    .span3
      = f.input :date, label: 'Fecha', as: :datepicker
    .span6
      = f.input :description, as: :text, label: 'Descripción' ,input_html: {rows: 3}

  .row-fluid
    %table#items.table.decorated
      %tr
        %th Item
        %th Cantidad
        %th

      = f.simple_fields_for :inventory_operation_details do |det|
        %tr.item
          %td
            = det.input :item, label: false, as: :autocomplete, 
              input_html: {class: 'item_id span10', placeholder: 'Escriba para buscar el ítem', 
              data: {new_url: '/items/new', source: items_path(format: :json)} }
          %td
            = det.input :quantity, label: false, input_html: {type: :decimal, size: 10}, data: {value: 'item.quantity'}
          %td
            %a.dark(href='javascript:;' data-on-click='item:deleteItem')= icon_delete

      %tr.last
        %td(colspan="3")
          %a.btn.btn-primary(href='javascript:;' data-on-click='inventory:addItem')
            %i.icon-plus-sign
            Adicionar item

    .form-actions
      = f.submit 'Salvar', class: 'btn btn-success b'

:javascript
  $(function() {
    var inv = new App.Inventory();
    rivets.bind($('#items tr.last'), {inventory: inv});
  })
